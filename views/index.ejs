<!DOCTYPE html>
<html lang="pt-br">

<head>
	<title>My Whatsapp</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<link rel="icon" type="image/png" sizes="192x192" href="imagens/favicons/android-icon-192x192.png">
	<link rel="apple-touch-icon" sizes="180x180" href="imagens/favicons/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="96x96" href="imagens/favicons/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="32x32" href="imagens/favicons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="imagens/favicons/favicon-16x16.png">
	<link rel="manifest" href="imagens/favicons/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="imagens/favicons/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	<!--- --------------------------------------------------------------------------------------------------------------------------- --->
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta property='og:title' content='My Whatsapp' />
	<meta name="title" content="My Whatsapp">
	<meta name="description" content="My Whatsapp" />
	<meta name="keywords" content="Alan Martines, My Whatsapp" />
	<meta name="robots" content="index, follow">
	<meta name='content-language' content='pt-br' />
	<meta name="author" content="Alan Martines">
	<!--- --------------------------------------------------------------------------------------------------------------------------- --->
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href="page/css/style.css" />
	<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="fontawesome-free/css/all.min.css" />
	<link rel="stylesheet" type="text/css" href="lobibox/css/lobibox.min.css" />
	<!--- --------------------------------------------------------------------------------------------------------------------------- --->
	<!--- JS --->
</head>

<body>
	<!-- Inicio - Image and text -->
	<nav class="navbar navbar-dark navbar-expand-lg">
		<a class="navbar-brand" href="../">
			<img src="imagens/favicons/favicon-32x32.png" height="32" class="img-fliud d-inline-block align-top" />
			My Whatsapp
		</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
			aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarNav">

			<ul class="navbar-nav mr-auto nav-flex-icons">

			</ul>
			<ul class="navbar-nav mx-auto nav-flex-icons">

			</ul>
			<ul class="navbar-nav ml-auto nav-flex-icons">

			</ul>
		</div>
	</nav>
	<div class="container-fluid">
		<div class="content">
			<div class="text-center">
				<!--Grid row-->
				<div class="row justify-content-center align-items-center">

					<div class="col-md-6 text-center mx-auto">
						<img class="img-fluid" id="image" src="imagens/body/readqrcode.png" draggable="false" alt="qr-code">
					</div>

					<div class="col-md-6 text-left mx-auto">
						<form class="form-signin text-center" id="start-form" method="post" action="javascript:void(0)"></form>
						<div class="form-group col-md-12">
							<div class="textOnInput">
								<label for="session">Session Name:</label>
								<input type="text" class="form-control" id="session" name="session"
									placeholder="Nome para identificação da sessão">
							</div>
						</div>

						<div class="form-group col-md-12">
							<div class="text-center">
							<button type="submit" name="send_form" id="send_form" class="btn btn-primary"><i
									class="fas fa-paper-plane"></i>&#32;Inikciar</button>
							</div>
						</div>

						</form>
					</div>

				</div>
			</div>
		</div>
	</div>
	</div>
	</div>
	</div>
	<!-- /container -->
	<!-- Footer -->
	<footer class="footer-distributed">
		<div class="footer-left">
			<div class="text-center">
				<img class="img-fluid" src="imagens/favicons/apple-icon-180x180.png" width="120px">
				</p>
				<p class="footer-company-name">Copyright &copy; 2022-
					<spam id="ano"></spam> EletroInfo - Desenvolvido por <b>Alan Martines</b>
				</p>
			</div>
		</div>
		<div class="footer-center">
			<div>
				<i class="fas fa-phone-alt"></i>
				<p>(67) 9 9293-5202 </p>
			</div>
		</div>
		<div class="footer-right">
			<p class="footer-company-about">
				<span>Nota!</span>“Sejam todos bem-vindos a API My Whatsapp
			</p>
			<div class="footer-icons">
				<a href="https://api.whatsapp.com/send/?phone=5567996787854&text&app_absent=0" target="_blank"><i
						class="fab fa-whatsapp"></i></a>
				<a href="#" target="_blank"><i class="fab fa-facebook-square"></i></a>
				<a href="# target=" _blank"><i class="fab fa-instagram"></i></a>
			</div>
		</div>
	</footer>
	<!-- Footer -->
	<!--- --------------------------------------------------------------------------------------------------------------------------- --->
	<!-- Primeiro o jQuery, depois o Popper.js, e depois o Bootstrap JS -->
	<script type="text/javascript" src="jquery/jquery-3.5.1.js"></script>
	<script type="text/javascript" src="jquery/popper.min.js"></script>
	<script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
	<!-- Inclusão do Plugin jQuery Validation-->
	<script type="text/javascript" src="jquery/jquery.validate.min.js"></script>
	<script type="text/javascript" src="jquery/jquery.maskedinput.min.js"></script>
	<script type="text/javascript" src="jquery/additional-methods.min.js"></script>
	<script type="text/javascript" src="lobibox/js/lobibox.min.js"> </script>
	<!--- --------------------------------------------------------------------------------------------------------------------------- --->
	<!-- JavaScript (Opcional) -->
	<script type="text/javascript" src="sweetalert2/js/sweetalert2.min.js"></script>
	<script type="text/javascript" src="axios/axios.min.js"></script>
	<script type="text/javascript" src="socket/socket.io.js"></script>
	<script type="text/javascript" src="page/js/custom.js"></script>
	<script type="text/javascript" src="page/js/start.js"></script>
	<script type="text/javascript">
		//
		let url;
		let host = '<%=host %>';
		let host_ssl = '<%=host_ssl %>';
		let port = '<%=port %>';
		url = host_ssl == '' ? `http://${host}:${port}` : `https://${host_ssl}`;
		const socket = io(url + '/', { transports: ['websocket'] });
		//
		function initSession(data) {
			$.ajax({
				type: 'POST',
				url: url + '/sistema/Start',
				data: data,
				dataType: 'json',
				beforeSend: function () {
					$("#send_form").html('<i class="fas fa-spinner fa-spin"></i> Logando ...');
				},
				success: function (response) {
					console.log(response);
					if (response.result === true) {
						$("#send_form").html('Logar');
						$("#login-alert").css('display', 'none');
						window.location.href = "../home/";
					} else {
						$("#send_form").html('Logar');
						console.log('Menssagem: ' + response.mensagem);
						$("#mensagem").html('<center>' +
							'<div class="panel-body padding-top-md" >' +
							'<div id="login-alert" class="alert alert-' + response.alerta + ' col-sm-6">' +
							response.iconem + '&#32;' + response.mensagem +
							'</div>' +
							'</div>' +
							'</center>');
						$("#login-alert").css('display', 'block');
						window.scrollTo(0, 0);
					}
				},
				error: function (XMLHttpRequest, textStatus, errorThrown) {
					$("#send_form").html('Logar');
					$("#mensagem").html('<center>' +
						'<div class="panel-body padding-top-md" >' +
						'<div id="login-alert" class="alert alert-danger col-sm-6">' +
						'<i class="fas fa-times"></i>&#32;Error: ' + errorThrown + ', Status: ' + textStatus +
						'</div>' +
						'</div>' +
						'</center>');
					$("#login-alert").css('display', 'block');
					window.scrollTo(0, 0);
				}
			}).fail(function (jqXHR, textStatus, error) {
				$("#send_form").html('Logar');
				$("#mensagem").html('<center>' +
					'<div class="panel-body padding-top-md" >' +
					'<div id="login-alert" class="alert alert-danger col-sm-6">' +
					'<i class="fas fa-times"></i>&#32;Fail: ' + jqXHR.responseText +
					'</div>' +
					'</div>' +
					'</center>');
				$("#login-alert").css('display', 'block');
				window.scrollTo(0, 0);
			});
		}
		//
		socket.on('qrCode', (qrCode) => {
			let session = document.getElementById('session').value;
			if (session === qrCode.session) {
				document.getElementById('image').src = qrCode.data;
			}
		});
		//
		socket.on('whatsapp-status', (status) => {
			if (status) {
				Swal.fire({
					icon: 'success',
					title: 'Sucesso',
					text: 'Whatsapp Aberto com sucesso'
				});
			} else {

			}
		});
	</script>
</body>

</html>